<template>
  <div class="design-system-demo">
    <div class="demo-container">
      <!-- é¡µé¢æ ‡é¢˜ -->
      <div class="demo-header">
        <h1 class="demo-title animate-on-scroll animate-fade-in-up">
          ğŸ¨ è®¾è®¡ç³»ç»Ÿæ¼”ç¤º
        </h1>
        <p class="demo-subtitle animate-on-scroll animate-fade-in-up">
          ç°ä»£åŒ–çš„ UI ç»„ä»¶å’ŒåŠ¨ç”»æ•ˆæœå±•ç¤º
        </p>
      </div>

      <!-- è‰²å½©ç³»ç»Ÿ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">è‰²å½©ç³»ç»Ÿ</h2>
        <div class="color-grid">
          <div class="color-item">
            <div class="color-swatch color-primary"></div>
            <span>ä¸»è‰²è°ƒ</span>
          </div>
          <div class="color-item">
            <div class="color-swatch color-success"></div>
            <span>æˆåŠŸè‰²</span>
          </div>
          <div class="color-item">
            <div class="color-swatch color-warning"></div>
            <span>è­¦å‘Šè‰²</span>
          </div>
          <div class="color-item">
            <div class="color-swatch color-danger"></div>
            <span>å±é™©è‰²</span>
          </div>
          <div class="color-item">
            <div class="color-swatch color-info"></div>
            <span>ä¿¡æ¯è‰²</span>
          </div>
        </div>
      </section>

      <!-- æŒ‰é’®ç»„ä»¶ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">æŒ‰é’®ç»„ä»¶</h2>
        <div class="button-grid">
          <button class="btn btn-primary">ä¸»è¦æŒ‰é’®</button>
          <button class="btn btn-secondary">æ¬¡è¦æŒ‰é’®</button>
          <button class="btn btn-success">æˆåŠŸæŒ‰é’®</button>
          <button class="btn btn-warning">è­¦å‘ŠæŒ‰é’®</button>
          <button class="btn btn-danger">å±é™©æŒ‰é’®</button>
          <button class="btn btn-ghost">å¹½çµæŒ‰é’®</button>
          <button class="btn btn-primary btn-sm">å°æŒ‰é’®</button>
          <button class="btn btn-primary btn-lg">å¤§æŒ‰é’®</button>
        </div>
      </section>

      <!-- å¡ç‰‡ç»„ä»¶ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">å¡ç‰‡ç»„ä»¶</h2>
        <div class="card-grid">
          <div class="card hover-lift">
            <h3>åŸºç¡€å¡ç‰‡</h3>
            <p>è¿™æ˜¯ä¸€ä¸ªåŸºç¡€çš„æ¯›ç»ç’ƒå¡ç‰‡ï¼Œå…·æœ‰æ‚¬æµ®æ•ˆæœã€‚</p>
            <button class="btn btn-primary btn-sm">äº†è§£æ›´å¤š</button>
          </div>
          <div class="card card-glass hover-lift">
            <h3>ç»ç’ƒå¡ç‰‡</h3>
            <p>é€æ˜çš„æ¯›ç»ç’ƒæ•ˆæœï¼Œæ›´åŠ è½»ç›ˆã€‚</p>
            <button class="btn btn-secondary btn-sm">æŸ¥çœ‹è¯¦æƒ…</button>
          </div>
          <div class="card card-primary hover-lift">
            <h3>ä¸»è‰²è°ƒå¡ç‰‡</h3>
            <p>ä½¿ç”¨ä¸»è‰²è°ƒçš„å¡ç‰‡å˜ä½“ã€‚</p>
            <button class="btn btn-primary btn-sm">ç«‹å³è¡ŒåŠ¨</button>
          </div>
        </div>
      </section>

      <!-- è¡¨å•ç»„ä»¶ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">è¡¨å•ç»„ä»¶</h2>
        <div class="form-demo">
          <div class="input-group">
            <label class="input-label">ç”¨æˆ·å</label>
            <input class="input" type="text" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" v-model="formData.username">
          </div>
          <div class="input-group">
            <label class="input-label">é‚®ç®±</label>
            <input class="input" type="email" placeholder="è¯·è¾“å…¥é‚®ç®±" v-model="formData.email">
          </div>
          <div class="input-group">
            <label class="input-label">çŠ¶æ€</label>
            <select class="select" v-model="formData.status">
              <option value="">è¯·é€‰æ‹©çŠ¶æ€</option>
              <option value="active">æ¿€æ´»</option>
              <option value="inactive">æœªæ¿€æ´»</option>
              <option value="pending">å¾…å¤„ç†</option>
            </select>
          </div>
          <div class="input-group">
            <label class="input-label">é”™è¯¯çŠ¶æ€æ¼”ç¤º</label>
            <input class="input input-error" type="text" placeholder="è¿™æ˜¯ä¸€ä¸ªé”™è¯¯çŠ¶æ€çš„è¾“å…¥æ¡†">
          </div>
        </div>
      </section>

      <!-- æ ‡ç­¾ç»„ä»¶ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">æ ‡ç­¾ç»„ä»¶</h2>
        <div class="tag-demo">
          <span class="tag tag-primary">ä¸»è¦æ ‡ç­¾</span>
          <span class="tag tag-success">æˆåŠŸæ ‡ç­¾</span>
          <span class="tag tag-warning">è­¦å‘Šæ ‡ç­¾</span>
          <span class="tag tag-danger">å±é™©æ ‡ç­¾</span>
          <span class="tag tag-info">ä¿¡æ¯æ ‡ç­¾</span>
          <span class="tag tag-gray">ç°è‰²æ ‡ç­¾</span>
        </div>
      </section>

      <!-- è¿›åº¦æ¡ç»„ä»¶ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">è¿›åº¦æ¡ç»„ä»¶</h2>
        <div class="progress-demo">
          <div class="progress-item">
            <span class="progress-label">é»˜è®¤è¿›åº¦ (75%)</span>
            <div class="progress">
              <div class="progress-bar" :style="{ width: '75%' }"></div>
            </div>
          </div>
          <div class="progress-item">
            <span class="progress-label">æˆåŠŸè¿›åº¦ (60%)</span>
            <div class="progress progress-success">
              <div class="progress-bar" :style="{ width: '60%' }"></div>
            </div>
          </div>
          <div class="progress-item">
            <span class="progress-label">è­¦å‘Šè¿›åº¦ (90%)</span>
            <div class="progress progress-warning">
              <div class="progress-bar" :style="{ width: '90%' }"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- åŠ è½½åŠ¨ç”» -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">åŠ è½½åŠ¨ç”»</h2>
        <div class="loading-demo">
          <div class="loading-item">
            <div class="loading-spinner"></div>
            <span>æ—‹è½¬åŠ è½½</span>
          </div>
          <div class="loading-item">
            <div class="loading-dots">
              <span></span>
              <span></span>
              <span></span>
            </div>
            <span>ç‚¹çŠ¶åŠ è½½</span>
          </div>
          <div class="loading-item">
            <div class="loading-wave">
              <span></span>
              <span></span>
              <span></span>
              <span></span>
              <span></span>
            </div>
            <span>æ³¢æµªåŠ è½½</span>
          </div>
          <div class="loading-item">
            <div class="loading-orbit"></div>
            <span>è½¨é“åŠ è½½</span>
          </div>
        </div>
      </section>

      <!-- ç‰¹æ®Šæ•ˆæœ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">ç‰¹æ®Šæ•ˆæœ</h2>
        <div class="effects-demo">
          <div class="effect-item glow">
            <h4>å‘å…‰æ•ˆæœ</h4>
            <p>è¾¹æ¡†å‘å…‰åŠ¨ç”»</p>
          </div>
          <div class="effect-item neon">
            <h4>éœ“è™¹æ•ˆæœ</h4>
            <p>æ–‡å­—éœ“è™¹é—ªçƒ</p>
          </div>
          <div class="effect-item pulse-scale">
            <h4>è„‰å†²æ•ˆæœ</h4>
            <p>ç¼©æ”¾è„‰å†²åŠ¨ç”»</p>
          </div>
          <div class="effect-item float">
            <h4>æµ®åŠ¨æ•ˆæœ</h4>
            <p>ä¸Šä¸‹æµ®åŠ¨åŠ¨ç”»</p>
          </div>
        </div>
      </section>

      <!-- å“åº”å¼ç½‘æ ¼ -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">å“åº”å¼ç½‘æ ¼</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div class="card" v-for="i in 8" :key="i">
            <h4>ç½‘æ ¼é¡¹ {{ i }}</h4>
            <p>å“åº”å¼ç½‘æ ¼å¸ƒå±€æ¼”ç¤º</p>
          </div>
        </div>
      </section>

      <!-- äº¤äº’æ¼”ç¤º -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">äº¤äº’æ¼”ç¤º</h2>
        <div class="interaction-demo">
          <button class="btn btn-primary" @click="showNotification('success')">
            æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
          </button>
          <button class="btn btn-warning" @click="showNotification('warning')">
            æ˜¾ç¤ºè­¦å‘Šé€šçŸ¥
          </button>
          <button class="btn btn-danger" @click="showNotification('error')">
            æ˜¾ç¤ºé”™è¯¯é€šçŸ¥
          </button>
          <button class="btn btn-secondary" @click="toggleTheme">
            åˆ‡æ¢ä¸»é¢˜
          </button>
          <button class="btn btn-ghost" @click="toggleLoading">
            {{ isLoading ? 'åœæ­¢åŠ è½½' : 'å¼€å§‹åŠ è½½' }}
          </button>
        </div>
      </section>

      <!-- å½“å‰çŠ¶æ€æ˜¾ç¤º -->
      <section class="demo-section animate-on-scroll animate-fade-in-up">
        <h2 class="section-title">å½“å‰çŠ¶æ€</h2>
        <div class="status-demo">
          <div class="status-item">
            <span class="status-label">å½“å‰ä¸»é¢˜:</span>
            <span class="tag tag-primary">{{ currentTheme }}</span>
          </div>
          <div class="status-item">
            <span class="status-label">å±å¹•æ–­ç‚¹:</span>
            <span class="tag tag-info">{{ currentBreakpoint }}</span>
          </div>
          <div class="status-item">
            <span class="status-label">å±å¹•å®½åº¦:</span>
            <span class="tag tag-gray">{{ screenWidth }}px</span>
          </div>
          <div class="status-item">
            <span class="status-label">åŠ è½½çŠ¶æ€:</span>
            <span class="tag" :class="isLoading ? 'tag-warning' : 'tag-success'">
              {{ isLoading ? 'åŠ è½½ä¸­' : 'ç©ºé—²' }}
            </span>
          </div>
        </div>
      </section>
    </div>

    <!-- é€šçŸ¥å®¹å™¨ -->
    <div class="notification-container">
      <transition-group name="list">
        <div
          v-for="notification in notifications"
          :key="notification.id"
          :class="['notification', `notification-${notification.type}`]"
        >
          <h4>{{ notification.title }}</h4>
          <p v-if="notification.message">{{ notification.message }}</p>
          <button 
            class="notification-close" 
            @click="removeNotification(notification.id)"
          >
            Ã—
          </button>
        </div>
      </transition-group>
    </div>

    <!-- åŠ è½½é®ç½© -->
    <div v-if="isLoading" class="loading-overlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <p>{{ loadingText }}</p>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { useDesignSystem } from '@/composables/useDesignSystem'

const {
  theme: { currentTheme, toggleTheme },
  loadingState: { isLoading, loadingText, startLoading, stopLoading },
  notification: { notifications, success, warning, error, removeNotification },
  breakpoints: { currentBreakpoint, screenWidth },
  scrollAnimation: { initObserver }
} = useDesignSystem()

// è¡¨å•æ•°æ®
const formData = ref({
  username: '',
  email: '',
  status: ''
})

// æ˜¾ç¤ºé€šçŸ¥
const showNotification = (type: 'success' | 'warning' | 'error') => {
  const messages = {
    success: { title: 'æ“ä½œæˆåŠŸ', message: 'æ‚¨çš„æ“ä½œå·²ç»æˆåŠŸå®Œæˆï¼' },
    warning: { title: 'æ³¨æ„è­¦å‘Š', message: 'è¯·æ£€æŸ¥æ‚¨çš„è¾“å…¥ä¿¡æ¯ã€‚' },
    error: { title: 'æ“ä½œå¤±è´¥', message: 'å‘ç”Ÿäº†é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚' }
  }
  
  const { title, message } = messages[type]
  
  if (type === 'success') {
    success(title, message)
  } else if (type === 'warning') {
    warning(title, message)
  } else {
    error(title, message)
  }
}

// åˆ‡æ¢åŠ è½½çŠ¶æ€
const toggleLoading = () => {
  if (isLoading.value) {
    stopLoading()
  } else {
    startLoading('æ­£åœ¨å¤„ç†è¯·æ±‚...')
    setTimeout(() => {
      stopLoading()
    }, 3000)
  }
}

onMounted(() => {
  // åˆå§‹åŒ–æ»šåŠ¨åŠ¨ç”»è§‚å¯Ÿå™¨
  setTimeout(() => {
    initObserver()
  }, 100)
})
</script>

<style scoped>
.design-system-demo {
  min-height: 100vh;
  padding: var(--spacing-8);
}

.demo-container {
  max-width: 1200px;
  margin: 0 auto;
}

.demo-header {
  text-align: center;
  margin-bottom: var(--spacing-16);
}

.demo-title {
  font-size: var(--font-size-5xl);
  font-weight: var(--font-weight-bold);
  color: white;
  margin-bottom: var(--spacing-4);
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.demo-subtitle {
  font-size: var(--font-size-xl);
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: 0;
}

.demo-section {
  margin-bottom: var(--spacing-16);
}

.section-title {
  font-size: var(--font-size-2xl);
  font-weight: var(--font-weight-semibold);
  color: white;
  margin-bottom: var(--spacing-8);
  text-align: center;
}

/* è‰²å½©ç½‘æ ¼ */
.color-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: var(--spacing-4);
}

.color-item {
  text-align: center;
}

.color-swatch {
  width: 80px;
  height: 80px;
  border-radius: var(--radius-xl);
  margin: 0 auto var(--spacing-2);
  box-shadow: var(--shadow-lg);
  transition: transform var(--duration-200) var(--ease-out);
}

.color-swatch:hover {
  transform: scale(1.1);
}

.color-primary { background: var(--color-primary); }
.color-success { background: var(--color-success); }
.color-warning { background: var(--color-warning); }
.color-danger { background: var(--color-danger); }
.color-info { background: var(--color-info); }

.color-item span {
  font-size: var(--font-size-sm);
  color: rgba(255, 255, 255, 0.8);
}

/* æŒ‰é’®ç½‘æ ¼ */
.button-grid {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-4);
  justify-content: center;
}

/* å¡ç‰‡ç½‘æ ¼ */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: var(--spacing-6);
}

/* è¡¨å•æ¼”ç¤º */
.form-demo {
  max-width: 500px;
  margin: 0 auto;
}

.input-group {
  margin-bottom: var(--spacing-4);
}

.input-label {
  display: block;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: rgba(255, 255, 255, 0.9);
  margin-bottom: var(--spacing-2);
}

/* æ ‡ç­¾æ¼”ç¤º */
.tag-demo {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-2);
  justify-content: center;
}

/* è¿›åº¦æ¡æ¼”ç¤º */
.progress-demo {
  max-width: 400px;
  margin: 0 auto;
}

.progress-item {
  margin-bottom: var(--spacing-4);
}

.progress-label {
  display: block;
  font-size: var(--font-size-sm);
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: var(--spacing-2);
}

/* åŠ è½½æ¼”ç¤º */
.loading-demo {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: var(--spacing-6);
}

.loading-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-2);
  color: rgba(255, 255, 255, 0.8);
  font-size: var(--font-size-sm);
}

/* ç‰¹æ•ˆæ¼”ç¤º */
.effects-demo {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-4);
}

.effect-item {
  background: var(--gradient-card);
  backdrop-filter: var(--backdrop-blur);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: var(--radius-xl);
  padding: var(--spacing-6);
  text-align: center;
}

.effect-item h4 {
  color: white;
  margin-bottom: var(--spacing-2);
}

.effect-item p {
  color: rgba(255, 255, 255, 0.7);
  font-size: var(--font-size-sm);
}

/* äº¤äº’æ¼”ç¤º */
.interaction-demo {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-4);
  justify-content: center;
}

/* çŠ¶æ€æ¼”ç¤º */
.status-demo {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--spacing-4);
}

.status-item {
  display: flex;
  align-items: center;
  gap: var(--spacing-2);
  padding: var(--spacing-3);
  background: rgba(255, 255, 255, 0.1);
  border-radius: var(--radius-lg);
}

.status-label {
  font-size: var(--font-size-sm);
  color: rgba(255, 255, 255, 0.8);
}

/* é€šçŸ¥å®¹å™¨ */
.notification-container {
  position: fixed;
  top: var(--spacing-4);
  right: var(--spacing-4);
  z-index: var(--z-index-toast);
  max-width: 300px;
}

.notification-close {
  position: absolute;
  top: var(--spacing-2);
  right: var(--spacing-2);
  width: 24px;
  height: 24px;
  border: none;
  background: rgba(255, 255, 255, 0.2);
  color: white;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--font-size-lg);
  line-height: 1;
  transition: background-color var(--duration-200) var(--ease-out);
}

.notification-close:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* åŠ è½½é®ç½© */
.loading-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.8);
  backdrop-filter: var(--backdrop-blur);
  z-index: var(--z-index-modal);
  display: flex;
  align-items: center;
  justify-content: center;
}

.loading-content {
  text-align: center;
  color: white;
}

.loading-content .loading-spinner {
  width: 60px;
  height: 60px;
  border-width: 4px;
  margin-bottom: var(--spacing-4);
}

.loading-content p {
  font-size: var(--font-size-lg);
  margin: 0;
}

/* å“åº”å¼è°ƒæ•´ */
@media (max-width: 768px) {
  .design-system-demo {
    padding: var(--spacing-4);
  }
  
  .demo-title {
    font-size: var(--font-size-3xl);
  }
  
  .demo-subtitle {
    font-size: var(--font-size-lg);
  }
  
  .card-grid {
    grid-template-columns: 1fr;
  }
  
  .button-grid,
  .interaction-demo {
    justify-content: stretch;
  }
  
  .button-grid .btn,
  .interaction-demo .btn {
    flex: 1;
    min-width: 0;
  }
}
</style>